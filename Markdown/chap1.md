# 第一章 Excel与数据格式

## 1.数据缘何而来

Execel是我们常见的用来进行数据处理的工具，其中Excel文件主要包含有2种格式分别是`xls`或`xlsx`，`xls`和`xlsx`主要区别如下：

| xls                                   | xlsx                           |
| :------------------------------------ | ------------------------------ |
| 97-2003版                             | 2007之后版                     |
| 只能打开xls格式，无法直接打开xlsx格式 | 可以直接打开xls、xlsx格式      |
| 只有65536行、256列                    | 可以有1048576行、16384列       |
| 占用空间大                            | 占用空间小，运算速度也会快一点 |

因此，推荐大家使用最新版本的Excel或者WPS进行相关的学习与操作。

### 1.1 了解Excel

Excel文每个数据文件叫做工作簿，每个工作簿里面含有多个工作表，每个工作表里面的格子叫做单元格。

在Excel中点击新建文档后，Excel默认的文档名称是工作簿1，也就是一个Excel文档，就是一个工作簿

![1.1](.\src\chap1\1.1.png)

在新建的工作簿中，可以看到左下方有`Sheet1`的标签，每个工作簿里面可以含有多个工作表，Excel表中最大支持255个工作表

![1.2](.\src\chap1\1.2.png)

单元格就是工作表中间每一个格子

![1.3](.\src\chap1\1.3.png)

在Excel最上方是工具栏，如果希望在Excel中导入第三方插件，可以点击`文件`-->`选项`-->`自定义功能区`点击右侧的√，即可导入相关模块

![1.5](.\src\chap1\1.5.gif)

### 1.2 Excel存储格式

Excel中的数据可以存储为不同的类型格式，其中常用的存储类似分别是xlsx、csv以及txt，一般情况下，csv文件采用是逗号分隔，txt文件采用的是制表符作为分隔，例如`data/chap1/Titanic_normal.csv`和`data/chap1/Titanic_tab.txt`，而在较为特殊的情况下，数据的分隔符合可能不是常规的分隔符合，例如`data/chap1/Titanic_special.txt`，使用记事本打开这个文件发现文件采用`|`作为分隔的符合，那么这样的文件如何使用Excel打开呢？

<img src=".\src\chap1\1.6.png" alt="1.6" style="zoom: 50%;" />

这里推荐大家使用以下的操作方案，操作路径为菜单栏选择：**数据-->获取和转换数据-->从文件/CSV**

![1.5](.\src\chap1\1.7.gif)点击**加载**后可以看到我们导入的数据集，接着按快捷键`ctrl+s`保存工作簿到本地。

> 至此我们已经成功加载数据集到工作表当中，需要注意的是此时构建的数据表跟原始数据是存在连接关系，更改csv文件的数据后在点击路径：**设计-外部表数据-刷新**后就可以更新工作表数据。如果要取消链接关系则点击路径：**设计-外部数据表-取消链接**即可。

## 2.Excel数据格式

### 2.1 单元格数据类型

打开`data/chap1/2.1.xlsx`文件，点击【单元格数据类型】工作表，可以看到Excel有11种数据类型

![2.1](.\src\chap1\2.1.png)

在平时工作和学习中常见的数据类型有3种分别是数字、文本和日期，接下来就详细讲解这3种格式的相关应用

#### 2.1.1 数字

数值是单元格最常见的数据之一，12位数的时候会以科学计数法显示。

打开`data/chap1/2.1.xlsx`文件，点击【真假数字】工作表看到展示的是真假数值列，真数值默认情况下是右对齐（方便观测数据位数），假数值是数值型文本属于**文本**，左上角会有个绿色三角错误检查，当数据是文本时，无法完成数字运算操作。

![2.2](.\src\chap1\2.2.png)

Excel会自带数据纠错功能，点击黄色感叹号可以看到，将文本转出数字，或者使用`=VALUE()`函数将文本转成数字

![2.3](.\src\chap1\2.3.gif)

#### 2.1.2 文本

文本为Excel中的常见格式，主要为文本字符串，例如下图就是典型的文本数据。当数据是文本类型时就可以完成文本数据相关操作。

![2.4](.\src\chap1\2.4.png)

#### 2.1.3 日期

Excel中的标准日期由年月日组成的数据，例如`2021/1/1`，同时日期又是很特殊的数值，在Excel里面日期最早是1900年1月1日，对应的数值为1，通过两日期相减可以得到日期相差的天数。需要注意的是如果是`2021-01-01`的数据就要看是否实际数据为`'2021/1/1'`，否则为文本型日期，需要进行转换才行。观察下图真假日期，可以发现真日期右对齐，假日期左对齐（内容跟显示的一致），真日期转格式可以看到单元格数据仍然是真日期格式（内容跟显示不一致）。

![2.5](.\src\chap1\2.5.gif)

### 2.2 单元格格式

设置单元格格式可以点击单元格后，**右键-设置单元格格式**选项，或者按快捷键**ctrl+1**，或者通过工具栏：**开始-数字**去快速做更改。单元格可以设置的格式类型包括：

* 数字：调整数值格式或者日期格式。
* 对齐：调整对齐方式。
* 字体：更改字体、字型、字号等。
* 边框：单元格边框设置。
* 填充：填充单元格背景颜色，标注数据经常使用。
* 保护：锁定单元格或者隐藏公式。

#### 2.2.1 数值格式

设置单元格格式分类选择数值，对数值设置小数点一般保留两位，同时能让数值对齐，使用千分位分隔符能更容易观察数值大小。

<img src=".\src\chap1\2.6.png" alt="2.6" style="zoom:80%;" />

#### 2.2.2 文本格式

文本常见的设置格式用于对文本进行加单引号、双引号或者逗号的情况。

例如对真假日期中的假日期增加单引号

![2.7](.\src\chap1\2.7.gif)

#### 2.2.3 日期格式

通过日期分类调整日期格式为年-月-日，需要注意的是文本型的日期格式无法调整，而数值是可以调整为日期。

![2.8](.\src\chap1\2.8.png)

### 2.3 转换单元格数据

#### 2.3.1 数值和文本相互转换

打开`data/chap1/2.1.xlsx`，将数值转换成文本

![2.9](.\src\chap1\2.9.gif)

#### 2.3.2 日期和文本相互转换

打开`data/chap1/2.1.xlsx`，将不规范日期转成规范日期，然后转成文本

![2.10](.\src\chap1\2.10.gif)

## 练习

1. 使用Excel数据导入功能，完成`data/chap1/Titanic_normal.csv`和`data/chap1/Titanic_special.txt`数据导入

2. 完成`data/chap1/2.1.xlsx`中案例1-4中的问题

   